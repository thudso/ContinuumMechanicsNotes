<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Tensor Calculus – MA4J1 Continuum Mechanics Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./massandforces.html" rel="next">
<link href="./tensoralgebra.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b7c2d8834e08b04a63bb76a724ffbcac.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-c1966a8c70583a3816b1e3a216c1caf1.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tensorcalculus.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tensor Calculus</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA4J1 Continuum Mechanics Notes</a> 
        <div class="sidebar-tools-main">
    <a href="./MA4J1-Continuum-Mechanics-Notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tensoralgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tensor Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tensorcalculus.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tensor Calculus</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./massandforces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mass, Forces and Stress</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kinematics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Kinematics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./balancelaws.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Balance laws</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-definitions" id="toc-basic-definitions" class="nav-link active" data-scroll-target="#basic-definitions"><span class="header-section-number">3.1</span> Basic definitions</a>
  <ul class="collapse">
  <li><a href="#points-tensors-and-representations" id="toc-points-tensors-and-representations" class="nav-link" data-scroll-target="#points-tensors-and-representations"><span class="header-section-number">3.1.1</span> Points, tensors and representations</a></li>
  <li><a href="#norms-and-order-symbols" id="toc-norms-and-order-symbols" class="nav-link" data-scroll-target="#norms-and-order-symbols"><span class="header-section-number">3.1.2</span> Norms and order symbols</a></li>
  </ul></li>
  <li><a href="#differentiation-of-tensor-fields" id="toc-differentiation-of-tensor-fields" class="nav-link" data-scroll-target="#differentiation-of-tensor-fields"><span class="header-section-number">3.2</span> Differentiation of tensor fields</a>
  <ul class="collapse">
  <li><a href="#derivatives-gradients" id="toc-derivatives-gradients" class="nav-link" data-scroll-target="#derivatives-gradients"><span class="header-section-number">3.2.1</span> Derivatives, gradients</a></li>
  <li><a href="#divergence" id="toc-divergence" class="nav-link" data-scroll-target="#divergence"><span class="header-section-number">3.2.2</span> Divergence</a></li>
  <li><a href="#curl" id="toc-curl" class="nav-link" data-scroll-target="#curl"><span class="header-section-number">3.2.3</span> Curl</a></li>
  <li><a href="#laplacian" id="toc-laplacian" class="nav-link" data-scroll-target="#laplacian"><span class="header-section-number">3.2.4</span> Laplacian</a></li>
  </ul></li>
  <li><a href="#some-important-integral-theorems" id="toc-some-important-integral-theorems" class="nav-link" data-scroll-target="#some-important-integral-theorems"><span class="header-section-number">3.3</span> Some important integral theorems</a>
  <ul class="collapse">
  <li><a href="#divergence-theorem" id="toc-divergence-theorem" class="nav-link" data-scroll-target="#divergence-theorem"><span class="header-section-number">3.3.1</span> Divergence Theorem</a></li>
  <li><a href="#further-useful-theorems-from-analysis" id="toc-further-useful-theorems-from-analysis" class="nav-link" data-scroll-target="#further-useful-theorems-from-analysis"><span class="header-section-number">3.3.2</span> Further useful theorems from Analysis</a></li>
  </ul></li>
  <li><a href="#functions-of-second-order-tensors" id="toc-functions-of-second-order-tensors" class="nav-link" data-scroll-target="#functions-of-second-order-tensors"><span class="header-section-number">3.4</span> Functions of second-order tensors</a>
  <ul class="collapse">
  <li><a href="#scalar-valued-functions-of-second-order-tensors" id="toc-scalar-valued-functions-of-second-order-tensors" class="nav-link" data-scroll-target="#scalar-valued-functions-of-second-order-tensors"><span class="header-section-number">3.4.1</span> Scalar-valued functions of second-order tensors</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tensor-calculus" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tensor Calculus</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="hidden">

</div>
<p>Realistic bodies have properties which vary from place to place within them. If we seek to describe their properties using the language of tensors introduced in the previous chapter, then a way to describe their properties is through tensor-valued functions which assign properties to spatial points in the body. More specifically, this chapter will consider functions <span class="math inline">\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span>, <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> and <span class="math inline">{\boldsymbol{S}}:{\mathbb{E}}^3\to{\mathcal{V}}^2</span> which describe these properties. We will also wish to consider functions which describe changes in the shape of a body, which take the form <span class="math inline">{\boldsymbol{\varphi}}:{\mathbb{E}}^3\to{\mathbb{E}}^3</span>, <span class="math inline">g:{\mathcal{V}}^2\to{\mathbb{R}}</span> and <span class="math inline">{\boldsymbol{A}}:{\mathcal{V}}^2\to{\mathcal{V}}^2</span>. Many of these concepts will already be very familiar to you from earlier calculus modules.</p>
<p><strong>Aims.</strong> By the end of this chapter, you should be able to:</p>
<ul>
<li><p>Give a definition of differentiability for scalar, vector, and tensor fields.</p></li>
<li><p>Define the divergence for vector and tensor fields.</p></li>
<li><p>Manipulate the gradient, divergence, curl, and Laplacian of fields in components using the summation convention, and so derive various product formula for these differential operators.</p></li>
<li><p>Recall and apply the Divergence Theorem, the Localisation Theorem and the Mean Value Theorem for multidimensional integrals.</p></li>
<li><p>Understand how to differentiate functions of second-order tensors.</p></li>
</ul>
<section id="basic-definitions" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="basic-definitions"><span class="header-section-number">3.1</span> Basic definitions</h2>
<section id="points-tensors-and-representations" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="points-tensors-and-representations"><span class="header-section-number">3.1.1</span> Points, tensors and representations</h3>
<p>Throughout this chapter, we assume that a single fixed Cartesian coordinate frame <span class="math inline">\{{\boldsymbol{e}}_i\}</span> has be specified for Euclidean space <span class="math inline">{\mathbb{E}}^3</span>, and we identify points <span class="math inline">{\boldsymbol{x}}\in{\mathbb{E}}^3</span>, vectors <span class="math inline">{\boldsymbol{v}}\in{\mathcal{V}}</span> and second-order tensors <span class="math inline">{\boldsymbol{S}}\in{\mathcal{V}}^2</span> with their respective matrix representations, writing <span class="math display">\begin{gathered}
  {\boldsymbol{x}}= x_i{\boldsymbol{e}}_i = \left(\begin{array}{c} x_1 \\ x_2 \\ x_3 \end{array}\right)\in{\mathbb{R}}^3,\quad
  {\boldsymbol{v}}= v_i{\boldsymbol{e}}_i = \left(\begin{array}{c} v_1 \\ v_2 \\ v_3 \end{array}\right)\in{\mathbb{R}}^3\\
  \text{and}\quad {\boldsymbol{S}}= S_{ij}{\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j =
  \left(\begin{array}{ccc}
          S_{11} &amp; S_{12} &amp; S_{13} \\
          S_{21} &amp; S_{22} &amp; S_{23} \\
          S_{31} &amp; S_{32} &amp; S_{33}
        \end{array}\right)\in{\mathbb{R}}^{3\times 3}.
\end{gathered}</span> It follows that we have identified <span class="math inline">{\mathbb{E}}^3</span> and <span class="math inline">{\mathcal{V}}</span> both with <span class="math inline">{\mathbb{R}}^3</span>, and <span class="math inline">{\mathcal{V}}^2</span> with <span class="math inline">{\mathbb{R}}^{3\times3}</span>. Any function of a spatial point <span class="math inline">{\boldsymbol{x}}</span> is a function of the three real variables <span class="math inline">(x_1,x_2,x_3)</span>, and a function of a second-order tensor <span class="math inline">{\boldsymbol{S}}</span> is a function of nine real variables, <span class="math inline">(S_{11},S_{12},\dots,S_{33})</span>.</p>
</section>
<section id="norms-and-order-symbols" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="norms-and-order-symbols"><span class="header-section-number">3.1.2</span> Norms and order symbols</h3>
<p>The standard <em>norms</em> on the spaces <span class="math inline">{\mathbb{E}}^3</span>, <span class="math inline">{\mathcal{V}}</span> and <span class="math inline">{\mathcal{V}}^2</span> are the scalar functions <span class="math display">\begin{aligned}
  |{\boldsymbol{x}}|&amp;=\sqrt{{\boldsymbol{x}}\cdot{\boldsymbol{x}}}&amp;&amp;\text{for any }{\boldsymbol{x}}\in{\mathbb{E}}^3,\\
  |{\boldsymbol{v}}|&amp;=\sqrt{{\boldsymbol{v}}\cdot{\boldsymbol{v}}}&amp;&amp;\text{for any }{\boldsymbol{v}}\in{\mathcal{V}},\\
  \text{and}\qquad|{\boldsymbol{S}}|&amp;=\sqrt{{\boldsymbol{S}}:{\boldsymbol{S}}}&amp;&amp;\text{for any }{\boldsymbol{S}}\in{\mathcal{V}}^2.
\end{aligned}</span></p>
<p>Just as the norms for vectors measure their size, <span class="math inline">|{\boldsymbol{S}}|</span> measures the size of the tensor <span class="math inline">{\boldsymbol{S}}</span>. The notion of a norm allows us to define limits on the spaces <span class="math inline">{\mathbb{E}}^3</span>, <span class="math inline">{\mathcal{V}}</span> and <span class="math inline">{\mathcal{V}}^2</span>, along with notions of continuity.</p>
<p>Consider a function <span class="math inline">{\boldsymbol{f}}:U\to W</span>, where <span class="math inline">U</span> and <span class="math inline">W</span> can be any of the spaces <span class="math inline">{\mathbb{E}}^3</span>, <span class="math inline">{\mathcal{V}}</span>, <span class="math inline">{\mathcal{V}}^2</span> or <span class="math inline">{\mathbb{R}}</span>. If there are constants <span class="math inline">C&gt;0</span> and <span class="math inline">r&gt;0</span> such that <span class="math inline">|{\boldsymbol{f}}({\boldsymbol{u}})|\leq C|{\boldsymbol{u}}|^r</span> as <span class="math inline">{\boldsymbol{u}}\to{\boldsymbol{0}}</span>, then we write <span class="math display">{\boldsymbol{f}}({\boldsymbol{u}}) = {O}(|{\boldsymbol{u}}|^r)\quad\text{as}\quad{\boldsymbol{u}}\to{\boldsymbol{0}}.</span> If there is a constant <span class="math inline">r&gt;0</span> such that <span class="math display">\frac{|{\boldsymbol{f}}({\boldsymbol{u}})|}{|{\boldsymbol{u}}|^r}\to0</span> as <span class="math inline">{\boldsymbol{u}}\to{\boldsymbol{0}}</span>, then we write <span class="math display">{\boldsymbol{f}}({\boldsymbol{u}})={o}(|{\boldsymbol{u}}|^r)\quad\text{as}\quad{\boldsymbol{u}}\to{\boldsymbol{0}}.</span> The symbols <span class="math inline">{O}</span> and <span class="math inline">{o}</span> are called the standard <em>order symbols</em>, and are used in many contexts.</p>
<p>The order symbols are a way to describe the behaviour of a function close to zero, or by translating, close to any other given value. We can read <span class="math inline">{O}(|{\boldsymbol{u}}|^r)</span> as a function which goes to zero ‘at least as fast as’ <span class="math inline">|{\boldsymbol{u}}|^r</span>, while <span class="math inline">{o}(|{\boldsymbol{u}}|^r)</span> should be read as a function which goes to zero ‘faster than’ <span class="math inline">|{\boldsymbol{u}}|^r</span>. This means that <span class="math inline">{O}{\boldsymbol{u}})={o}(|{\boldsymbol{u}}|^r)</span> implies that <span class="math inline">{\boldsymbol{f}}({\boldsymbol{u}})={O}(|{\boldsymbol{u}}|^r)</span>, but not the converse. When <span class="math inline">p&gt;r</span>, it is however true that <span class="math inline">{\boldsymbol{f}}({\boldsymbol{u}})={O}(|{\boldsymbol{u}}|^p)</span> implies <span class="math inline">{\boldsymbol{f}}({\boldsymbol{u}})={o}(|{\boldsymbol{u}}|^r)</span>.</p>
<p>Given two functions <span class="math inline">{\boldsymbol{f}},{\boldsymbol{g}}:U\to W</span>, we will use the notation <span class="math display">{\boldsymbol{f}}({\boldsymbol{u}}) = {\boldsymbol{g}}({\boldsymbol{u}})+{O}(|{\boldsymbol{u}}|^r)\quad\text{as }{\boldsymbol{u}}\to{\boldsymbol{0}}</span> to mean that <span class="math display">{\boldsymbol{f}}({\boldsymbol{u}}) - {\boldsymbol{g}}({\boldsymbol{u}}) = {O}(|{\boldsymbol{u}}|^r)\quad\text{as }{\boldsymbol{u}}\to{\boldsymbol{0}},</span> and the same for the order symbol <span class="math inline">{o}</span>. We sometimes indicate the limit <span class="math inline">{\boldsymbol{u}}\to{\boldsymbol{0}}</span> using the informal terminology ‘for <span class="math inline">{\boldsymbol{u}}</span> small’.</p>
</section>
</section>
<section id="differentiation-of-tensor-fields" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="differentiation-of-tensor-fields"><span class="header-section-number">3.2</span> Differentiation of tensor fields</h2>
<p>In this module, a <em>field</em> is a function defined in a region of <span class="math inline">{\mathbb{E}}^3</span>. A <em>scalar field</em> means a function <span class="math inline">\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span>, a <em>vector field</em> means a function <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span>, and a <em>second-order tensor field</em> means a function <span class="math inline">{\boldsymbol{S}}:{\mathbb{E}}^3\to{\mathcal{V}}^2</span>. This section will discuss the definitions and properties of various differential operators we may apply to these fields.</p>
<section id="derivatives-gradients" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="derivatives-gradients"><span class="header-section-number">3.2.1</span> Derivatives, gradients</h3>
<p>The derivative or gradient of a field is the central notion of differentiation: other operations will be based on these basic definitions.</p>
<p>A scalar field <span class="math inline">\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span> is said to be differentiable at <span class="math inline">{\boldsymbol{x}}\in{\mathbb{E}}^3</span> if there exists a vector <span class="math inline">\nabla \phi({\boldsymbol{x}})\in{\mathcal{V}}</span> such that <span class="math display">\phi({\boldsymbol{x}}+{\boldsymbol{h}}) = \phi({\boldsymbol{x}}) +\nabla \phi({\boldsymbol{x}})\cdot{\boldsymbol{h}}+{o}(|{\boldsymbol{h}}|),</span> or equivalently, such that <span class="math display">\nabla\phi({\boldsymbol{x}})\cdot{\boldsymbol{a}}= \frac{d}{d\alpha}\phi({\boldsymbol{x}}+\alpha{\boldsymbol{a}})\bigg|_{\alpha=0}\quad\text{for all }{\boldsymbol{a}}\in{\mathcal{V}},</span> where <span class="math inline">\alpha\in{\mathbb{R}}</span>. <span class="math inline">\nabla\phi({\boldsymbol{x}})</span> is called the <em>derivative</em> or <em>gradient</em> of <span class="math inline">\phi</span> at the point <span class="math inline">{\boldsymbol{x}}</span>.</p>
<p>A vector field <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> is said to be differentiable at <span class="math inline">{\boldsymbol{x}}\in{\mathbb{E}}^3</span> if there exists a second-order tensor <span class="math inline">\nabla {\boldsymbol{v}}({\boldsymbol{x}})\in{\mathcal{V}}^2</span> such that <span class="math display">{\boldsymbol{v}}({\boldsymbol{x}}+{\boldsymbol{h}}) = {\boldsymbol{v}}({\boldsymbol{x}}) +\nabla {\boldsymbol{v}}({\boldsymbol{x}}){\boldsymbol{h}}+{o}(|{\boldsymbol{h}}|),</span> or equivalently, such that <span class="math display">\nabla{\boldsymbol{v}}({\boldsymbol{x}}){\boldsymbol{a}}= \frac{d}{d\alpha}{\boldsymbol{v}}({\boldsymbol{x}}+\alpha{\boldsymbol{a}})\bigg|_{\alpha=0}\quad\text{for all }{\boldsymbol{a}}\in{\mathcal{V}},</span> where <span class="math inline">\alpha\in{\mathbb{R}}</span>. <span class="math inline">\nabla{\boldsymbol{v}}({\boldsymbol{x}})</span> is again called the <em>derivative</em> or <em>gradient</em> of <span class="math inline">{\boldsymbol{v}}</span> at the point <span class="math inline">{\boldsymbol{x}}</span>.</p>
<div id="prp-gradientincoords" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.1 (Gradients in coordinates)</strong></span> Suppose that <span class="math inline">\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span> and <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> are differentiable at <span class="math inline">{\boldsymbol{x}}</span>, and let <span class="math inline">\{{\boldsymbol{e}}_i\}</span> be an arbitrary Cartesian coordinate frame. Then <span class="math display">\nabla\phi({\boldsymbol{x}}) = \frac{\partial\phi}{\partial x_i}({\boldsymbol{x}}){\boldsymbol{e}}_i\quad\text{and}\quad
    \nabla{\boldsymbol{v}}({\boldsymbol{x}}) = \frac{\partial v_i}{\partial x_j}({\boldsymbol{x}}){\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j,</span> where <span class="math inline">{\boldsymbol{v}}({\boldsymbol{x}}) = v_i({\boldsymbol{x}}){\boldsymbol{e}}_i</span> and <span class="math inline">x_i</span> are the coordinates of <span class="math inline">{\boldsymbol{x}}</span> in the frame considered.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Writing <span class="math inline">\phi</span> and <span class="math inline">v_i</span> as functions of the coordinates <span class="math inline">x_i</span>, we have <span class="math inline">\phi({\boldsymbol{x}}) = \phi(x_1,x_2,x_3)</span> and <span class="math inline">v_i({\boldsymbol{x}}) = v_i(x_1,x_2,x_3)</span>. If <span class="math inline">{\boldsymbol{a}}= a_k{\boldsymbol{e}}_k</span>, then we can use the chain rule to find <span class="math display">\nabla\phi({\boldsymbol{x}})\cdot{\boldsymbol{a}}= \frac{d}{d\alpha}\phi({\boldsymbol{x}}+\alpha {\boldsymbol{a}})\bigg|_{\alpha=0}= \frac{\partial \phi}{\partial x_i}({\boldsymbol{x}})a_i = \frac{\partial \phi}{\partial x_i}({\boldsymbol{x}}){\boldsymbol{e}}_i\cdot a_k{\boldsymbol{e}}_k.</span> Since this must hold for all <span class="math inline">{\boldsymbol{a}}</span>, the first result follows. Similarly, we find <span class="math display">\frac{d}{d\alpha}v_i({\boldsymbol{x}}+\alpha {\boldsymbol{a}})\bigg|_{\alpha=0}= \frac{\partial v_i}{\partial x_j}({\boldsymbol{x}})a_j = \frac{\partial v_i}{\partial x_j}({\boldsymbol{x}}){\boldsymbol{e}}_j\cdot a_k{\boldsymbol{e}}_k,</span> and so <span class="math display">\nabla{\boldsymbol{v}}({\boldsymbol{x}}){\boldsymbol{a}}= {\boldsymbol{e}}_i\frac{d}{d\alpha}v_i({\boldsymbol{x}}+\alpha{\boldsymbol{a}})\bigg|_{\alpha=0}
    =\bigg(\frac{\partial v_i}{\partial x_j}({\boldsymbol{x}}){\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j\bigg)a_k{\boldsymbol{e}}_k.</span> Again, since this holds for all <span class="math inline">{\boldsymbol{a}}\in{\mathcal{V}}</span>, we obtain the desired result.</p>
</div>
<p><strong>Important note:</strong> We will often use the shorthand <span class="math inline">\phi_{,i}</span> to denote <span class="math inline">\frac{\partial \phi}{\partial x_i}</span> and <span class="math inline">v_{i,j}</span> to denote <span class="math inline">\frac{\partial v_i}{\partial x_j}</span>.</p>
</section>
<section id="divergence" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="divergence"><span class="header-section-number">3.2.2</span> Divergence</h3>
<p>The <em>divergence</em> of a vector field <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> is the scalar field <span class="math inline">\nabla\cdot{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathbb{R}}</span> defined to be <span class="math display">\nabla\cdot{\boldsymbol{v}}= {\operatorname{tr}}(\nabla{\boldsymbol{v}}).</span> If <span class="math inline">{\boldsymbol{v}}</span> is the velocity field in a flowing fluid, then <span class="math inline">(\nabla\cdot{\boldsymbol{v}})({\boldsymbol{x}})</span> can be interpreted as the rate of volume expansion at the point <span class="math inline">{\boldsymbol{x}}</span>.</p>
<p>Similarly, we can also define a divergence for second-order tensor fields. If <span class="math inline">{\boldsymbol{S}}:{\mathbb{E}}^3\to{\mathcal{V}}^2</span>, then the vector field <span class="math inline">\nabla\cdot{\boldsymbol{S}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> is defined to be the vector field which satisfies <span class="math display">(\nabla \cdot {\boldsymbol{S}})\cdot {\boldsymbol{a}}= \nabla \cdot({\boldsymbol{S}}^T{\boldsymbol{a}})</span> for all constant vectors <span class="math inline">{\boldsymbol{a}}\in{\mathcal{V}}</span>. The field <span class="math inline">\nabla\cdot{\boldsymbol{S}}</span> is again called the <em>divergence</em> of <span class="math inline">{\boldsymbol{S}}</span>.</p>
<p>The following result provides a coordinate expression for these two notions of divergence in any coordinate frame.</p>
<div id="prp-divincoords" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.2 (Divergence in coordinates)</strong></span> Let <span class="math inline">\{{\boldsymbol{e}}_i\}</span> be an arbitrary coordinate frame, and let <span class="math inline">{\boldsymbol{v}}({\boldsymbol{x}}) = v_i({\boldsymbol{x}}){\boldsymbol{e}}_i</span>, and <span class="math inline">{\boldsymbol{S}}({\boldsymbol{x}}) = S_{ij}({\boldsymbol{x}}){\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j</span>. Then <span class="math display">(\nabla\cdot{\boldsymbol{v}})({\boldsymbol{x}}) = \frac{\partial v_i}{\partial x_i}({\boldsymbol{x}}) = v_{i,i}({\boldsymbol{x}})
    \quad\text{and}\quad (\nabla\cdot{\boldsymbol{S}})({\boldsymbol{x}}) = \frac{\partial S_{ij}}{\partial x_j}({\boldsymbol{x}}){\boldsymbol{e}}_i = S_{ij,j}{\boldsymbol{e}}_i,</span> where <span class="math inline">x_i</span> are the coordinates of <span class="math inline">{\boldsymbol{x}}</span> with respect to the frame.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We prove only the second expression, since the first follows directly from <a href="#prp-gradientincoords" class="quarto-xref">Proposition&nbsp;<span>3.1</span></a> and the component expression for the trace. Fix <span class="math inline">{\boldsymbol{a}}= a_k{\boldsymbol{e}}_k</span> and let <span class="math inline">{\boldsymbol{q}}= {\boldsymbol{S}}^T{\boldsymbol{a}}</span>. In components, we have <span class="math inline">{\boldsymbol{q}}= q_j{\boldsymbol{e}}_j</span> with <span class="math inline">q_j = S_{ij}a_i</span>. Then, using the definition and the first expression, we have <span class="math display">(\nabla \cdot{\boldsymbol{S}})\cdot{\boldsymbol{a}}= \nabla\cdot{\boldsymbol{q}}= q_{i,i} = S_{ij,j}a_i = \big(s_{ij,j}{\boldsymbol{e}}_i\big)\cdot a_k{\boldsymbol{e}}_k.</span> Since this holds for any <span class="math inline">{\boldsymbol{a}}\in{\mathcal{V}}</span>, we have that <span class="math inline">\nabla \cdot{\boldsymbol{S}}= S_{ij,j}{\boldsymbol{e}}_i</span>.</p>
</div>
<div id="prp-productrules" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.3 (Product rules)</strong></span> Let <span class="math inline">\phi</span>, <span class="math inline">{\boldsymbol{v}}</span> and <span class="math inline">{\boldsymbol{S}}</span> respectively be scalar, vector and second-order tensor fields. Then <span class="math display">
\begin{gathered}
    \nabla(\phi{\boldsymbol{v}}) = {\boldsymbol{v}}\otimes\nabla\phi+\phi\nabla{\boldsymbol{v}},\\
    \nabla\cdot(\phi{\boldsymbol{S}}) = \phi\nabla\cdot{\boldsymbol{S}}+{\boldsymbol{S}}\nabla\phi,\\
    \nabla\cdot({\boldsymbol{S}}^T{\boldsymbol{v}}) = (\nabla\cdot{\boldsymbol{S}})\cdot{\boldsymbol{v}}+ {\boldsymbol{S}}:\nabla {\boldsymbol{v}}.
\end{gathered}
</span></p>
</div>
<p><strong>Exercise:</strong> Prove this proposition by using the component expressions given above.</p>
</section>
<section id="curl" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="curl"><span class="header-section-number">3.2.3</span> Curl</h3>
<p>The <em>curl</em> of a vector field <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> is the vector field <span class="math inline">\nabla\times{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> which satisfies <span class="math display">(\nabla\times{\boldsymbol{f}})\times{\boldsymbol{a}}= (\nabla{\boldsymbol{v}}-\nabla {\boldsymbol{v}}^T){\boldsymbol{a}}</span> for any constant vector <span class="math inline">{\boldsymbol{a}}\in{\mathcal{V}}</span>.</p>
<p>If <span class="math inline">{\boldsymbol{v}}</span> is the velocity field of a flowing fluid, then the curl provides information on the rate and direction of rotation of this field. In practice, we use the following result to compute the curl in a particular coordinate frame.</p>
<div id="prp-curlincoords" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.4 (Curl in coordinates)</strong></span> Let <span class="math inline">\{{\boldsymbol{e}}_i\}</span> be an arbitrary Cartesian coordinate frame, and let <span class="math inline">{\boldsymbol{v}}({\boldsymbol{x}}) = v_i({\boldsymbol{x}}){\boldsymbol{e}}_i</span>. Then <span class="math display">(\nabla\times{\boldsymbol{v}})({\boldsymbol{x}}) = \epsilon_{ijk}v_{i,k}({\boldsymbol{x}}){\boldsymbol{e}}_j,</span> where <span class="math inline">x_i</span> are the coordinates of <span class="math inline">{\boldsymbol{x}}</span> with respect to the frame. Equivalently, we have <span class="math display">\nabla\times{\boldsymbol{v}}= \bigg(\frac{\partial v_3}{\partial x_2}-\frac{\partial v_2}{\partial x_3}\bigg){\boldsymbol{e}}_1+\bigg(\frac{\partial v_1}{\partial x_3}-\frac{\partial v_3}{\partial x_1}\bigg){\boldsymbol{e}}_2+\bigg(\frac{\partial v_2}{\partial x_1}-\frac{\partial v_1}{\partial x_2}\bigg){\boldsymbol{e}}_3.</span></p>
</div>
</section>
<section id="laplacian" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="laplacian"><span class="header-section-number">3.2.4</span> Laplacian</h3>
<p>The <em>Laplacian</em> of a scalar field <span class="math inline">\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span> is the scalar field <span class="math inline">\nabla^2\phi:{\mathbb{E}}^3\to{\mathbb{R}}</span> defined via <span class="math display">\nabla^2\phi = \nabla\cdot(\nabla \phi).</span> Likewise, the <em>Laplacian</em> of a vector field <span class="math inline">{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> is the vector field <span class="math inline">\nabla^2{\boldsymbol{v}}:{\mathbb{E}}^3\to{\mathcal{V}}</span> defined by <span class="math display">\nabla^2{\boldsymbol{v}}= \nabla\cdot(\nabla {\boldsymbol{v}}).</span> We remark that in alternative standard notation the Laplacian is also often denoted <span class="math inline">\Delta</span>, i.e.&nbsp;<span class="math inline">\Delta\phi=\nabla^2\phi</span>. In coordinates, we have the following representation.</p>
<div id="prp-Laplacianincoords" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.5 (Laplacian in coordinates)</strong></span> Let <span class="math inline">\{{\boldsymbol{e}}_i\}</span> be an arbitrary Cartesian coordinate frame, and let <span class="math inline">{\boldsymbol{v}}({\boldsymbol{x}}) = v_i({\boldsymbol{x}}){\boldsymbol{e}}_i</span>. Then <span class="math display">\nabla^2\phi({\boldsymbol{x}}) = \phi_{,ii}({\boldsymbol{x}}) \quad\text{and}\quad\nabla^2{\boldsymbol{v}}({\boldsymbol{x}}) = v_{i,jj}({\boldsymbol{x}}){\boldsymbol{e}}_i,</span> where <span class="math inline">x_i</span> are the coordinates of <span class="math inline">{\boldsymbol{x}}</span> with respect to the frame.</p>
</div>
<p><strong>Exercise:</strong> Prove this proposition.</p>
</section>
</section>
<section id="some-important-integral-theorems" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="some-important-integral-theorems"><span class="header-section-number">3.3</span> Some important integral theorems</h2>
<p>In this section, we provide statements of various important theorems about integrals. We will use these theorems to convert between integral and differential forms of the balance laws we derive later, and to prove various other facts about the physical tensors we study.</p>
<section id="divergence-theorem" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="divergence-theorem"><span class="header-section-number">3.3.1</span> Divergence Theorem</h3>
<p>Recall that the divergence theorem for vector fields connects the volume integral of the divergence of a field over a region to the total flux across the boundary of the region. Various versions of this theorem can be proved under different assumptions on the properties of the region. The particular class of regions <span class="math inline">B\subset{\mathbb{E}}^3</span> we will consider are those which are <em>regular</em> in the sense that:</p>
<ul>
<li><p><span class="math inline">B</span> consists of a finite number of disjoint, open and bounded components;</p></li>
<li><p>The bounding surface <span class="math inline">\partial B</span> is piecewise smooth and consists of a finite number of disjoint components; and</p></li>
<li><p>Each component of <span class="math inline">\partial B</span> is orientable in the sense that it has two clearly distinct sides.</p></li>
</ul>
<p>Examples of regions that do fit these assumptions include pretty much all shapes we would like to consider for the purposes of modelling, but it is worth thinking about what sorts of regions do not fit these assumptions!</p>
<div id="prp-vectordivtheorem" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.6 (Vector divergence theorem)</strong></span> Suppose <span class="math inline">B</span> is a regular region in <span class="math inline">{\mathbb{E}}^3</span> with a piecewise smooth boundary <span class="math inline">\partial B</span>, and consider a vector field <span class="math inline">{\boldsymbol{v}}:B\to{\mathcal{V}}</span>. Then <span class="math display">\int_{\partial B} {\boldsymbol{v}}\cdot{\boldsymbol{n}}{\,{\mathrm{d}}A_{{\boldsymbol{x}}}}= \int_B\nabla\cdot{\boldsymbol{v}}{\,{\mathrm{d}}V_{{\boldsymbol{x}}}},</span> or in components, <span class="math display">\int_{\partial B}v_in_i {\,{\mathrm{d}}A_{{\boldsymbol{x}}}}= \int_Bv_{i,i} {\,{\mathrm{d}}V_{{\boldsymbol{x}}}},</span> where <span class="math inline">{\boldsymbol{n}}</span> is the outward-point unit normal field on <span class="math inline">\partial B</span>. The quantity on the left-hand side of these equations is called the <em>flux</em> of <span class="math inline">{\boldsymbol{v}}</span> across the oriented surface <span class="math inline">\partial B</span>.</p>
</div>
<p>We note that this theorem allows us to understand what the divergence of a vector field really means. Consider a point <span class="math inline">{\boldsymbol{y}}</span>, and the ball of radius <span class="math inline">\delta</span> around that point, <span class="math inline">B_\delta({\boldsymbol{y}})</span>. If <span class="math inline">{\boldsymbol{v}}</span> is smooth, we can use the Divergence theorem and Taylor expand the argument in the volume integral to conclude that <span class="math display">\begin{aligned}
  \int_{\partial B_\delta({\boldsymbol{y}})}{\boldsymbol{v}}({\boldsymbol{x}})\cdot{\boldsymbol{n}}({\boldsymbol{x}}){\,{\mathrm{d}}A_{{\boldsymbol{x}}}}
  &amp;= \int_{B_\delta({\boldsymbol{y}})}(\nabla \cdot {\boldsymbol{v}})({\boldsymbol{x}}){\,{\mathrm{d}}V_{{\boldsymbol{x}}}}\\
  &amp;= \int_{B_\delta({\boldsymbol{y}})}\big[(\nabla \cdot {\boldsymbol{v}})({\boldsymbol{y}})+{O}(\delta)\big]{\,{\mathrm{d}}V_{{\boldsymbol{x}}}}\\
  &amp;= {\operatorname{vol}}\big(B_\delta({\boldsymbol{y}})\big)\big[(\nabla \cdot {\boldsymbol{v}})({\boldsymbol{y}})+{O}(\delta)\big].
\end{aligned}</span> This implies that, in the limit as <span class="math inline">\delta\to0</span>, <span class="math display">(\nabla \cdot {\boldsymbol{v}})({\boldsymbol{y}}) = \lim_{\delta\to0}\frac{1}{{\operatorname{vol}}(B_\delta({\boldsymbol{y}}))}\int_{\partial B_\delta({\boldsymbol{y}})}{\boldsymbol{v}}\cdot{\boldsymbol{n}}{\,{\mathrm{d}}A_{{\boldsymbol{x}}}}.</span> If we interpret <span class="math inline">{\boldsymbol{v}}</span> as a velocity field of a fluid, then the flux integral is the volume of fluid per unit time leaving <span class="math inline">B_\delta({\boldsymbol{y}})</span>. When divided by the volume, we therefore obtain the proportion of fluid leaving <span class="math inline">B_\delta({\boldsymbol{y}})</span> per unit time, and so <span class="math inline">(\nabla\cdot{\boldsymbol{v}})({\boldsymbol{y}})</span> is a measure of the volume expansion at the point <span class="math inline">{\boldsymbol{y}}</span>.</p>
<p>We can generalise the divergence theorem to second-order tensors as follows:</p>
<div id="prp-tensordivthm" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.7 (Tensor divergence theorem)</strong></span> Suppose <span class="math inline">B</span> is a regular region in <span class="math inline">{\mathbb{E}}^3</span> with a piecewise smooth boundary <span class="math inline">\partial B</span>, and consider a second-order tensor field <span class="math inline">{\boldsymbol{S}}:B\to{\mathcal{V}}^2</span>. Then <span class="math display">\int_{\partial B} {\boldsymbol{S}}{\boldsymbol{n}}{\,{\mathrm{d}}A_{{\boldsymbol{x}}}}= \int_B\nabla\cdot{\boldsymbol{S}}{\,{\mathrm{d}}V_{{\boldsymbol{x}}}},</span> or in components, <span class="math display">\int_{\partial B}S_{ij}n_j {\,{\mathrm{d}}A_{{\boldsymbol{x}}}}= \int_BS_{ij,j} {\,{\mathrm{d}}V_{{\boldsymbol{x}}}},</span> where <span class="math inline">{\boldsymbol{n}}</span> is the outward-point unit normal field on <span class="math inline">\partial B</span>.</p>
</div>
<!-- ### Stokes Theorem -->
<!-- Next, we recap Stokes' theorem, which relates the line integral of a -->
<!-- vector field along a simple closed curve $C$ to the surface integral of -->
<!-- the curl over a surface $\Gamma$ with boundary $C=\partial\Gamma$. As -->
<!-- with the divergence theorem, various versions of this theorem can be -->
<!-- proved under different assumptions on the properties of both $C$ and -->
<!-- $\Gamma$. In particular, we assume that: -->
<!-- -   The curve $C$ does not intersect itself (it is simple), is of -->
<!--     bounded length, and is piecewise smooth; and -->
<!-- -   The surface $\Gamma$ is orientable (it has a well-defined normal -->
<!--     field $\bfn$), is of bounded area, and is piecewise smooth. -->
<!-- The orientations for the tangent field $\bft$ defined on $C$ and the -->
<!-- normal field $\bfn$ defined on $\Gamma$ are assumed to be such that a -->
<!-- person walking around $C$ in the direction of $\bft$ with their head -->
<!-- pointing in the direction $\bfn$ would find the surface $\Gamma$ on -->
<!-- their left. -->
<!-- ::: {.proposition} -->
<!-- Let $\Gamma$ be a surface in $\bbE^3$ with a piecewise smooth boundary -->
<!-- curve $C=\partial \Gamma$, and consider a vector field -->
<!-- $\bfv:\bbE^3\to\calV$. Then -->
<!-- $$\int_\Gamma (\nabla\times\bfv)\cdot\bfn \dAx = \int_C \bfv\cdot\bft \ds,$$ -->
<!-- or in components, -->
<!-- $$\int_{\Gamma}\epsilon_{ijk}v_{j,k}n_i \dAx = \int_C v_it_i \ds,$$ where -->
<!-- $\bfn$ is a unit normal field on $\Gamma$, and $\bft$ is a unit tangent -->
<!-- field on $C$ oriented consistently as discussed above. Then quantity on -->
<!-- the right-hand side of the above relation is called the *circulation* of -->
<!-- $\bfv$ around the oriented curve $C$. -->
<!-- ::: -->
<!-- As with the Divergence Theorem, Stokes' theorem can be used to gain an -->
<!-- idea of the meaning of the curl. Consider a point $\bfy$ and let -->
<!-- $\Gamma_\delta$ be a disc centred at $\bfy$ with radius $\delta$. Then, -->
<!-- assuming $\bfv$ is smooth, employing Stokes' theorem and Taylor -->
<!-- expanding the surface integral, we have $$\begin{aligned} -->
<!--   \int_{\partial \Gamma_\delta} \bfv\bft\ds &= \int_{\Gamma_\delta} (\nabla\times\bfv)(\bfx)\cdot\bfn(\bfx)\dAx\\ -->
<!--                                              &= \int_{\Gamma_\delta} \big[(\nabla\times\bfv)(\bfy)\cdot\bfn(\bfy)+\bigO(\delta)\big]\dAx\\ -->
<!--   &= \area(\Gamma_\delta)\big[(\nabla\times\bfv)(\bfy)\cdot\bfn(\bfy)+\bigO(\delta)\big]. -->
<!-- \end{aligned}$$ Rearranging and considering the limit where -->
<!-- $\delta\to0$, we have -->
<!-- $$\bfn(\bfy)\cdot(\nabla\times\bfv)(\bfy) = \lim_{\delta\to0}\frac{1}{\area(\Gamma_\delta)}\int_{\partial \Gamma_\delta}\bfv\cdot\bft\ds.$$ -->
<!-- If the curl of $\bfv$ at $\bfy$ is non-zro, we may now -->
<!-- (retrospectively!) choose the orientation of $\Gamma_\delta$ such that -->
<!-- $$\bfn(\bfy) = \frac{\nabla \times\bfv(\bfy)}{|\nabla \times\bfv(\bfy)|},$$ -->
<!-- which entails that -->
<!-- $$|(\nabla\times\bfv)(\bfy)| = \lim_{\delta\to0}\frac{1}{\area(\Gamma_\delta)}\int_{\partial \Gamma_\delta}\bfv\cdot\bft\ds.$$ -->
<!-- If $\bfv$ is the velocity field of a fluid in space, then the line -->
<!-- integral divided by the area tells us the proportion of fluid being -->
<!-- carried around $\partial\Gamma_\delta$ (as opposed to escaping crossing -->
<!-- into or out of this disc). This is a measure of the angular velocity of -->
<!-- the fluid at the point $\bfy$ (in fact, $(\nabla\times\bfv)$ is twice -->
<!-- the angular velocity). -->
</section>
<section id="further-useful-theorems-from-analysis" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="further-useful-theorems-from-analysis"><span class="header-section-number">3.3.2</span> Further useful theorems from Analysis</h3>
<p>For some purposes we will need the following two theorems. The first, a localisation theorem, states that if the integral of a scalar field on any subset of its domain is zero, then the field itself must be zero everywhere. The second provides forms of the Mean Value Theorem for multidimensional integrals.</p>
<div id="prp-localisation" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.8 (Localisation theorem)</strong></span> Consider a continuous function <span class="math inline">\phi:B\to{\mathbb{R}}</span> where <span class="math inline">B</span> is an open subset of <span class="math inline">{\mathbb{E}}^3</span>, and let <span class="math inline">\Omega</span> denote an arbitrary open subset of <span class="math inline">B</span>. If <span class="math display">\int_\Omega \phi({\boldsymbol{x}}){\,{\mathrm{d}}V_{{\boldsymbol{x}}}}= 0\quad\text{for any }\Omega\subseteq B,</span> then it follows that <span class="math inline">\phi({\boldsymbol{x}})=0</span> for all <span class="math inline">{\boldsymbol{x}}\in B</span>.</p>
</div>
<p><strong>Exercise:</strong> Prove this by contradiction (assume that <span class="math inline">\phi</span> is non-zero somewhere, and proceed from here).</p>
<div id="prp-MVTsurfaces" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.9 (Mean Value Theorem for surfaces)</strong></span> Let <span class="math inline">B</span> be an open, connected subset of <span class="math inline">{\mathbb{E}}^3</span>, and let <span class="math inline">\Sigma</span> be a compact, connected surface in <span class="math inline">B</span>. Suppose that <span class="math inline">\phi:B\to{\mathbb{R}}</span> is continuous; then there exist points <span class="math inline">{\boldsymbol{x}}'\in B</span> and <span class="math inline">{\boldsymbol{x}}''\in\Sigma</span> such that <span class="math display">\phi({\boldsymbol{x}}') = \frac{1}{{\operatorname{vol}}(B)}\int_B \phi({\boldsymbol{x}}){\,{\mathrm{d}}V_{{\boldsymbol{x}}}}\quad\text{and}\quad
    \phi({\boldsymbol{x}}'') = \frac{1}{{\operatorname{area}}(\Sigma)}\int_\Sigma \phi({\boldsymbol{x}}){\,{\mathrm{d}}A_{{\boldsymbol{x}}}}.</span></p>
</div>
<p><strong>Exercise:</strong> Prove this. The method of proof is similar to the version you will have seen in Analysis, it just requires some more thought due to the multidimensional setting.</p>
</section>
</section>
<section id="functions-of-second-order-tensors" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="functions-of-second-order-tensors"><span class="header-section-number">3.4</span> Functions of second-order tensors</h2>
<p>In this section, we generalise the notions of derivatives which you know for functions which take scalars and vectors as input to the case where functions take second-order tensors a input. In general we consider functions <span class="math inline">\psi:{\mathcal{V}}^2\to{\mathbb{R}}</span>; examples of such functions include the trace, determinant and norm defined above. <!-- and $\bfSigma:\calV^2\to\calV^2$. --> <!-- Examples of the former functions include the trace and determinant, and --> <!-- examples of the latter include the exponential function introduced in --> <!-- Section [\[sec:second-order-tensors\]](#sec:second-order-tensors){reference-type="ref" --> <!-- reference="sec:second-order-tensors"}, as well as the stress response --> <!-- functions we will consider later. --></p>
<section id="scalar-valued-functions-of-second-order-tensors" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="scalar-valued-functions-of-second-order-tensors"><span class="header-section-number">3.4.1</span> Scalar-valued functions of second-order tensors</h3>
<p>A function <span class="math inline">\psi:{\mathcal{V}}^2\to{\mathbb{R}}</span> is said to be differentiable at <span class="math inline">{\boldsymbol{A}}\in{\mathcal{V}}^2</span> if there exists a second-order tensor <span class="math inline">D\psi({\boldsymbol{A}})\in{\mathcal{V}}^2</span> such that <span class="math display">\psi({\boldsymbol{A}}+{\boldsymbol{H}}) = \psi({\boldsymbol{A}}) + D\psi({\boldsymbol{A}}):{\boldsymbol{H}}+{o}(|{\boldsymbol{H}}|),</span> or equivalently, <span class="math display">D\psi({\boldsymbol{A}}):{\boldsymbol{B}}= \frac{d}{d\alpha}\psi({\boldsymbol{A}}+\alpha{\boldsymbol{B}})\bigg|_{\alpha=0}\quad\text{for all }{\boldsymbol{B}}\in{\mathcal{V}}^2,</span> where <span class="math inline">\alpha\in{\mathbb{R}}</span>. The tensor <span class="math inline">D\psi({\boldsymbol{A}})</span> is called the <em>derivative</em> of <span class="math inline">\psi</span> at <span class="math inline">{\boldsymbol{A}}</span>.</p>
<p>If <span class="math inline">\psi</span> is differentiable at <span class="math inline">{\boldsymbol{A}}</span> the derivative is unique, a fact which can be shown in much the same way as for the derivative of a real-valued function. The second characterisation follows from the first by choosing <span class="math inline">{\boldsymbol{H}}=\alpha{\boldsymbol{B}}</span>, dividing by <span class="math inline">\alpha</span> and letting <span class="math inline">\alpha\to0</span>.</p>
<p>The following result provides a characterisation of the derivative in any coordinate frame.</p>
<div id="prp-derivativetensor2scalar" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.10 (Differentiating scalar functions of tensors)</strong></span> Let <span class="math inline">\{{\boldsymbol{e}}_i\}</span> be an arbitrary coordinate frame, and <span class="math inline">\psi:{\mathcal{V}}^2\to{\mathbb{R}}</span>. Then <span class="math display">D\psi({\boldsymbol{A}}) = \frac{\partial \psi}{\partial A_{ij}}({\boldsymbol{A}}){\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j,</span> where <span class="math inline">A_{ij}</span> are the components of <span class="math inline">{\boldsymbol{A}}\in{\mathcal{V}}^2</span> in the frame <span class="math inline">\{{\boldsymbol{e}}_i\}</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Writing <span class="math inline">\psi</span> as a function of the components <span class="math inline">A_{ij}</span> (and abusing notation), we have <span class="math inline">\psi({\boldsymbol{A}}) = \psi(A_{11},A_{12}\ldots,A_{33})</span>. For any scalar <span class="math inline">\alpha</span> and tensor <span class="math inline">{\boldsymbol{B}}=B_{kl}{\boldsymbol{e}}_k\otimes {\boldsymbol{e}}_l</span>, this gives <span class="math display">\psi({\boldsymbol{A}}+\alpha{\boldsymbol{B}})=\psi(A_{11}+\alpha B_{11},\ldots,A_{33}+\alpha B_{33}).</span> Applying the chain rule, we have <span class="math display">
\begin{aligned}
    D\psi({\boldsymbol{A}}):{\boldsymbol{B}}&amp;= \frac{d}{d\alpha} \psi({\boldsymbol{A}}+\alpha{\boldsymbol{B}})\bigg|_{\alpha=0}\\
                     &amp;= \frac{\partial \psi}{\partial A_{ij}}({\boldsymbol{A}})B_{ij}\\
                     &amp;= \bigg(\frac{\partial \psi}{\partial A_{ij}}({\boldsymbol{A}}){\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j\bigg):B_{kl}{\boldsymbol{e}}_k\otimes{\boldsymbol{e}}_l,
\end{aligned}
</span> where we have used that <span class="math inline">({\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j):({\boldsymbol{e}}_k\otimes{\boldsymbol{e}}_l)=\delta_{ik}\delta_{jl}</span>. This implies the result.</p>
</div>
<p>Note that the derivative of a scalar-valued function of a second-order tensor is a second-order tensor valued function, <span class="math inline">D\psi:{\mathcal{V}}^2\to{\mathcal{V}}^2</span>. Also, if third-order partial derivatives of <span class="math inline">\psi</span> exist, then we can use Taylor’s Theorem to deduce that for any small (in the sense of the norm) tensor <span class="math inline">{\boldsymbol{H}}\in{\mathcal{V}}^2</span>, we have <span class="math display">\psi({\boldsymbol{A}}+{\boldsymbol{H}})=\psi({\boldsymbol{A}})+\frac{\partial \psi}{\partial A_{ij}}({\boldsymbol{A}}):H_{ij}+{O}(|{\boldsymbol{H}}|^2),</span> or equivalently <span class="math display">\psi({\boldsymbol{A}}+{\boldsymbol{H}})=\psi({\boldsymbol{A}})+D\psi({\boldsymbol{A}}):{\boldsymbol{H}}+{O}(|{\boldsymbol{H}}|^2),</span> which is strong than the assumption that the difference is <span class="math inline">{o}(|{\boldsymbol{H}}|)</span> as indicated in the definition.</p>
<p><strong>Example:</strong> Consider the function <span class="math inline">\psi:{\mathcal{V}}^2\to{\mathbb{R}}</span> defined by <span class="math display">\psi({\boldsymbol{A}})=\tfrac12 {\boldsymbol{A}}:{\boldsymbol{A}}= \tfrac12 A_{kl}A_{kl}.</span> To compute <span class="math inline">D\psi({\boldsymbol{A}})</span>, we compute the partial derivative with respect to a general component <span class="math inline">A_{ij}</span>, obtaining via the product rule that <span class="math display">\frac{\partial \psi}{\partial A_{ij}} = \frac12\frac{\partial A_{kl}}{\partial A_{ij}}A_{kl}+
  \frac12A_{kl}\frac{\partial A_{kl}}{\partial A_{ij}}=\frac{\partial A_{kl}}{\partial A_{ij}}A_{kl}.</span> Now, since <span class="math inline">\frac{\partial A_{kl}}{\partial A_{ij}}=\delta_{ik}\delta_{jl}</span>, we have <span class="math display">\frac{\partial \psi}{\partial A_{ij}} = \delta_{ik}\delta_{jl}A_{kl} = A_{ij},</span> and hence we deduce <span class="math inline">D\psi({\boldsymbol{A}}) = A_{ij}{\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j = {\boldsymbol{A}}</span>.</p>
<div id="prp-derivativedet" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.11 (Derivative of determinant)</strong></span> Let <span class="math inline">\psi({\boldsymbol{S}}) = \det{\boldsymbol{S}}</span>. If <span class="math inline">{\boldsymbol{A}}</span> is invertible, then the derivative of <span class="math inline">\psi</span> at <span class="math inline">{\boldsymbol{A}}</span> is <span class="math display">D\psi({\boldsymbol{A}}) = \det({\boldsymbol{A}}){\boldsymbol{A}}^{-T}.</span> The second-order tensor <span class="math inline">\det({\boldsymbol{A}}){\boldsymbol{A}}^{-T}</span> is also called the <em>cofactor</em> tensor, denoted <span class="math inline">{\operatorname{cof}}({\boldsymbol{A}})=\det({\boldsymbol{A}}){\boldsymbol{A}}^{-T}</span>.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Let <span class="math inline">{\boldsymbol{B}}\in{\mathcal{V}}^2</span> be arbitrary, and set <span class="math inline">\lambda = -\tfrac1\alpha</span>. Then <span class="math display">\begin{aligned}
    \psi({\boldsymbol{A}}+\alpha{\boldsymbol{B}})
    &amp;= \det({\boldsymbol{A}}+\alpha{\boldsymbol{B}})\\
    &amp;= \det\big(\alpha{\boldsymbol{A}}({\boldsymbol{A}}^{-1}{\boldsymbol{B}}-\lambda{\boldsymbol{I}})\big)\\
    &amp;= \det\big(\alpha{\boldsymbol{A}})\det({\boldsymbol{A}}^{-1}{\boldsymbol{B}}-\lambda{\boldsymbol{I}}).
\end{aligned}</span> For the first factor above, we note that <span class="math inline">\det(\alpha{\boldsymbol{A}}) = \alpha^3\det {\boldsymbol{A}}</span>. The second factor is the characteristic polynomial of <span class="math inline">{\boldsymbol{A}}^{-1}{\boldsymbol{B}}</span>, and so recalling the facts about the principal invariants stated in <a href="tensoralgebra.html#sec-eigenv-eigenv-princ" class="quarto-xref"><span>Section 2.4.9</span></a>, we have <span class="math display">
\begin{aligned}
    \det({\boldsymbol{A}}^{-1}{\boldsymbol{B}}-\lambda{\boldsymbol{I}})
    &amp;=-\lambda^3+\lambda^2I_1({\boldsymbol{A}}^{-1}{\boldsymbol{B}})-\lambda I_2({\boldsymbol{A}}^{-1}{\boldsymbol{B}})+I_3({\boldsymbol{A}}^{-1}{\boldsymbol{B}})\\
    &amp;=\frac{1}{\alpha^3}+\frac{1}{\alpha^2}I_1({\boldsymbol{A}}^{-1}{\boldsymbol{B}})+\frac1\alpha I_2({\boldsymbol{A}}^{-1}{\boldsymbol{B}})+I_3({\boldsymbol{A}}^{-1}{\boldsymbol{B}}),
\end{aligned}
</span> and hence <span class="math display">\psi({\boldsymbol{A}}+\alpha{\boldsymbol{B}}) =  \det{\boldsymbol{A}}\big(1+\alpha I_1({\boldsymbol{A}}^{-1}{\boldsymbol{B}})+\alpha^2 I_2({\boldsymbol{A}}^{-1}{\boldsymbol{B}})+\alpha^3 I_3({\boldsymbol{A}}^{-1}{\boldsymbol{B}})\big).</span> Differentiating with respect to <span class="math inline">\alpha</span> and evaluating at <span class="math inline">\alpha=0</span>, we have <span class="math display">D\psi({\boldsymbol{A}}):{\boldsymbol{B}}= \det({\boldsymbol{A}})I_1({\boldsymbol{A}}^{-1}{\boldsymbol{B}}).</span> Since <span class="math inline">I_1({\boldsymbol{A}}^{-1}{\boldsymbol{B}}) = {\operatorname{tr}}({\boldsymbol{A}}^{-1}{\boldsymbol{B}}) = {\boldsymbol{A}}^{-T}:{\boldsymbol{B}}</span>, we deduce that <span class="math display">D\psi({\boldsymbol{A}}):{\boldsymbol{B}}= \det({\boldsymbol{A}}){\boldsymbol{A}}^{-T}:{\boldsymbol{B}},</span> and so the result follows from the arbitrariness of <span class="math inline">{\boldsymbol{B}}</span>.</p>
</div>
<p>The following result is a handy consequence of the result above.</p>
<div id="prp-dotdet" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3.12 (Time derivative of determinant)</strong></span> Let <span class="math inline">{\boldsymbol{S}}:{\mathbb{R}}\to{\mathcal{V}}^2</span> be a time-dependent second-order tensor. Then <span class="math display">\frac{d}{dt}\det{\boldsymbol{S}}= \det({\boldsymbol{S}}){\operatorname{tr}}({\boldsymbol{S}}^{-1}\dot{{\boldsymbol{S}}}) = \det({\boldsymbol{S}}){\boldsymbol{S}}^{-T}:\dot{{\boldsymbol{S}}},</span> where <span class="math display">\dot{{\boldsymbol{S}}} = \frac{d{\boldsymbol{S}}}{dt} = \frac{dS_{ij}}{dt}{\boldsymbol{e}}_i\otimes{\boldsymbol{e}}_j.</span></p>
</div>
<p><strong>Exercise:</strong> Prove this result using the chain rule.</p>
<!-- ### Second-order tensor-valued functions of second-order tensors -->
<!-- A second-order-tensor-valued function $\bfSigma:\calV^2\to\calV^2$ is -->
<!-- said to be *differentiable* at $\bfA\in\calV^2$ if there exists a -->
<!-- fourth-order tensor $D\bfSigma(\bfA)\in\calV^4$ such that -->
<!-- $$\bfSigma(\bfA+\bfH) = \bfSigma(\bfA)+ D\bfSigma(\bfA)\bfH+\litO(|\bfH|),$$ -->
<!-- or equivalently -->
<!-- $$D\bfSigma(\bfA):\bfB = \frac{d}{d\alpha}\bfSigma(\bfA+\alpha\bfB)\bigg|_{\alpha=0}\quad\text{for any }\bfB\in\calV^2,$$ -->
<!-- where $\alpha\in\bbR$. The tensor $D\bfSigma(\bfA)$ is called the -->
<!-- *derivative* of $\bfSigma$ at $\bfA$. -->
<!-- As with the derivative for scalar-valued functions, the tensor -->
<!-- $D\bfSigma(\bfA)$ is unique when it exists, and similar steps can be -->
<!-- taken to show that the latter characterisation follows from the former. -->
<!-- The following result provides a characterisation of the derivative in a -->
<!-- given coordinate frame. -->
<!-- ::: {.proposition} -->
<!-- Let $\{\bfe_i\}$ be an arbitrary Cartesian coordinate frame, and let -->
<!-- $\bfSigma(\bfA)=\Sigma_{ij}(\bfA)\bfe_i\otimes\bfe_j$. Then -->
<!-- $$D\bfSigma(\bfA) = \frac{\partial \Sigma_{ij}}{\partial A_{kl}}(\bfA)\bfe_i\otimes\bfe_j\otimes\bfe_k\otimes\bfe_l,$$ -->
<!-- where $A_{kl}$ are the components of $\bfA$ in the given frame. -->
<!-- ::: -->
<!-- We note that the derivative of a second-order tensor-valued function -->
<!-- $\bfSigma:\calV^2\to\calV^2$ is a fourth-order tensor valued function -->
<!-- $D\bfSigma:\calV^2\to\calV^4$. Similarly, we can also show that if -->
<!-- third-order partial derivatives exist, then we have -->
<!-- $$\bfSigma(\bfA+\bfH) = \bfSigma(\bfA)+D\bfSigma(\bfA)\bfH+\bigO(|\bfH|^2)$$ -->
<!-- (where we note the use of the $\bigO$ in place of the $\litO$ in the -->
<!-- original definition). -->
<!-- **Example:** Consider the function $\bfSigma:\calV^2\to\calV^2$ defined by -->
<!-- $$\bfSigma(\bfA) = \tr(\bfA)\bfA.$$ Then the components -->
<!-- $[D\bfSigma(\bfA)]_{ijkl}$ are $$\begin{aligned} -->
<!-- _{ijkl} -->
<!--   &= \frac{\partial \Sigma_{ij}}{\partial A_{kl}}(\bfA)\\ -->
<!--   &=\frac{\partial A_{mm}}{\partial A_{kl}} A_{ij}+A_{mm} \frac{\partial A_{ij}}{\partial A_{kl}},\\ -->
<!--   &=\delta_{mk}\delta_{lm}A_{ij}+A_{mm}\delta_{ik}\delta_{jl}\\ -->
<!--   &=\delta_{kl}A_{ij}+A_{mm}\delta_{ik}\delta_{jl} -->
<!-- \end{aligned}$$ For any $\bfB\in\calV^2$, we have $$\begin{aligned} -->
<!--   D\bfSigma(\bfA)\bfB -->
<!--   &= [D\bfSigma(\bfA)]_{ijkl}B_{kl}\bfe_i\otimes\bfe_j\\ -->
<!--   &= (\delta_{kl}A_{ij}+A_{mm}\delta_{ik}\delta_{jl})B_{kl}\bfe_i\otimes\bfe_j\\ -->
<!--   &= (A_{ij}B_{kk}+A_{mm}B_{ij})\bfe_i\otimes\bfe_j\\ -->
<!--   &= \tr(\bfB)\bfA+\tr(\bfA)\bfB. -->
<!-- \end{aligned}$$ -->


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./tensoralgebra.html" class="pagination-link" aria-label="Tensor Algebra">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Tensor Algebra</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./massandforces.html" class="pagination-link" aria-label="Mass, Forces and Stress">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Mass, Forces and Stress</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>